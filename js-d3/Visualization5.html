<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;

  width: 960px;
}

text {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

#svgHere{

  width: 400px; height:392px; position: relative; left: 15px;
}

#buttons{
  position: absolute; top: 480px; left: 8px;
}
#order{
  position: absolute; top: 480px; left: 120px;
}
</style>
<body>
    <img src = "logo.jpg" />
    <div id='svgHere'></div> <label><input type="checkbox" id="order"> </label>
    <div id='buttons' >
      <form action="visualization1.html">
        <input type="submit" id="Visualization1" value="Visualization1"/>
      </form>
      <form action="visualization2.html">
        <input type="submit" id="Visualization2" value="Visualization2"/>
      </form>
      <form action="visualization3.html">
        <input type="submit" id="Visualization3" value="Visualization3"/>
      </form>
      <form action="visualization4.html">
        <input type="submit" id="Visualization4" value="Visualization4"/>
      </form>
      <form action="visualization5.html">
        <input type="submit" id="Visualization5" value="Visualization5"/>
      </form>
    </div>
    <p style="position: absolute; top: 464px; left: 230px; width: 300px;">Visualization 5. Y axis is count and ordinal X axis is the pieces by their starting location. See the legends for bar colours. Use the radio box for deccending order, uncheck it for column first order. Reset the page for row first order.</p>

</body>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script>
var data= {
  "a2" : [ [ "65817", "4487" ] ],
  "b2" : [ [ "65291", "7440" ] ],
  "c2" : [ [ "76037", "9806" ] ],
  "d2" : [ [ "88839", "10794" ] ],
  "e2" : [ [ "95515", "13142" ] ],
  "f2" : [ [ "67316", "7700" ] ],
  "g2" : [ [ "63170", "5563" ] ],
  "h2" : [ [ "66288", "4377" ] ],
  "a7" : [ [ "67685", "4330" ] ],
  "b7" : [ [ "68738", "7880" ] ],
  "c7" : [ [ "79646", "12244" ] ],
  "d7" : [ [ "88283", "12115" ] ],
  "e7" : [ [ "90720", "13371" ] ],
  "f7" : [ [ "64164", "7671" ] ],
  "g7" : [ [ "64994", "5899" ] ],
  "h7" : [ [ "64957", "4542" ] ],
  "a1" : [ [ "113139", "18419" ] ],
  "b1" : [ [ "134937", "20528" ] ],
  "c1" : [ [ "119195", "23198" ] ],
  "d1" : [ [ "170574", "41375" ] ],
  "e1" : [ [ "175232", "11538" ] ],
  "f1" : [ [ "127251", "24583" ] ],
  "g1" : [ [ "128195", "23783" ] ],
  "h1" : [ [ "131377", "18756" ] ],
  "a8" : [ [ "113343", "18759" ] ],
  "b8" : [ [ "132352", "20587" ] ],
  "c8" : [ [ "116001", "22296" ] ],
  "d8" : [ [ "168350", "41017" ] ],
  "e8" : [ [ "183764", "13617" ] ],
  "f8" : [ [ "123866", "24429" ] ],
  "g8" : [ [ "124883", "20434" ] ],
  "h8" : [ [ "126591", "18190" ] ]

}

var temp2 = d3.entries(data).map(function(d) { return {"x":  d.key,"y": d.value[0][0], "y0" : 0} })
var temp3 = d3.entries(data).map(function(d) { return {"x": d.key ,"y": d.value[0][1] , "y0" : 0} })
var temp4 = [temp2,temp3];
//console.log(temp[2].value[0][0]);

var n = 2, // number of layers
m = 32, // number of samples per layer

layers =temp4,
yGroupMax = d3.max(layers, function(layer) { return d3.max(layer, function(d) { return d.y; }); }),
yStackMax = d3.max(layers, function(layer) { return d3.max(layer, function(d) { return d.y0 + d.y; }); });



var margin = {top: 10, right: 0, bottom: 0, left: 32},
width = 700 - margin.left - margin.right,
height = 410 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
.domain(d3.keys(data))
.rangeRoundBands([0, width], .08);

var y = d3.scale.linear()
.domain([0, 180000])
.range([height-20, 0]);

var color = d3.scale.linear()
.domain([0, n - 1])
.range(["#b58863", "#f0d9b5"]);

var yAxis = d3.svg.axis()
.scale(y)
.tickSize(0)
.tickPadding(6)
.orient("left");
var xAxis = d3.svg.axis()
.scale(x)
.tickSize(0)
.tickPadding(6)
.orient("bottom");

var svg = d3.select("body").select("#svgHere").append("svg")
.attr("width", width + margin.left + margin.right)
.attr("height", height + margin.top + margin.bottom)
.append("g")
.attr("transform", "translate(42,10)");

var layer = svg.selectAll(".layer")
.data(layers)
.enter().append("g")
.attr("class", "layer")
.style("fill", function(d, i) { return color(i); });

var rect = layer.selectAll("rect")
.data(function(d) { return d; })
.enter().append("rect")
.attr("x", function(d) { return x(d.x); })
.attr("y", height)
.attr("width", x.rangeBand())
.attr("height", 0);

rect.transition()
.delay(function(d, i) { return i * 10; })
.attr("y", function(d) { return y(d.y0 + d.y); })
.attr("height", function(d) { return y(d.y0) - y(d.y0 + d.y); });

svg.append("g")
.attr("class", "x axis")
.attr("transform", "translate(0, 380)")
.call(xAxis);

svg.append("g")
.attr("class", "y axis")
.attr("transform","translate(0,0)")
.call(yAxis);

var legend = svg.selectAll(".legend")
.data(color.domain().slice().reverse())
.enter().append("g")
.attr("class", "legend")
.attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });

legend.append("rect")
.attr("x", 18)
.attr("width", 18)
.attr("height", 18)
.style("fill", color);

legend.append("text")
.attr("x", 40)
.attr("y", 9)
.attr("dy", ".35em")
.style("text-anchor", "start")
.text(function(d) { if(d==0) {return "moves"} return "captures"; });

d3.select("input").on("change", change);

//var sortTimeout = setTimeout(function() {
//  d3.select("input").property("checked", true).each(change);
//}, 2000);

function change() {
  //clearTimeout(sortTimeout);

  // Copy-on-write since tweens are evaluated after a delay.
  var x0 = x.domain(temp2.sort(this.checked
    ? function(a, b) { return b.y - a.y; }
    : function(a, b) { return d3.ascending(a.x, b.x); })
    .map(function(d) { return d.x; }))
    .copy();

    var transition = svg.transition().duration(750),
    delay = function(d, i) { return i * 10; };

    transition.selectAll("rect")
    .delay(delay)
    .attr("x", function(d) { return x0(d.x); });

    transition.select(".x.axis")
    .call(xAxis)
    .selectAll("g")
    .delay(delay);
  }

</script>
